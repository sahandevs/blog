# چالش های پیاده سازی ratelimiter برای یک CDN

![Ratelimit funnel#@{"maxHeight":300}](ratelimit_funnel.png)

اگر جایی توی اینترنت با پیام
`TOO_MANY_REQUESTS`
روبرو شدید، احتمال خیلی زیاد اون وبسایت
rate limit
داشته و تعداد درخواست های شما از حد مجاز تعریف شده برای اون وبسایت بیشتر شده و
rate limit
شدید. به طور کلی
rate limit
روشی برای کنترل جریان هست. توی یک سد اگر میخوایم میزان عبور آب رو کنترل کنیم، میایم جریان آب رو محدود میکنیم به طوری که فقط
x
مقدار آب در بازه زمان
t
بتونه عبور کنه. توی یک وب سرور این موضوع این طور تعمیم داده میشه که تعداد درخواست های یک کاربر(معمولا کاربران با
IP Adress
شون متمایز میشن) در یک بازه زمانی
t
(مثلا ۱۰ ثانیه‌ای) از x تا بیشتر نشه.

> نکته: منظور از بازه زمانی توی هر الگوریتم ممکنه متفاوت باشه که جلوتر در موردش صحبت خواهیم کرد.

معمولا مسیر های حساس یا مسیر هایی که پردازش سنگینی نیاز دارند رو
rate limit
می‌کنند. مثلا اگر مسیری مثل
`/auth/sendOTP`
که کارش ارسال رمز یکبار مصرف به یک شماره هست،
rate limit
نداشته باشه، یک نفر میتونه به تعداد دفعات زیادی این
endpoint
رو صدا بزنه و اعتبار پنل
SMS
اتون رو خالی کنه. حالا این
rate limit
کردن چطوری انجام میشه؟
