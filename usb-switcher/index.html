<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link href="https://fonts.googleapis.com/css?family=Source Code Pro" rel="stylesheet"/><meta name="generator" content="Gatsby 4.25.9"/><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" property="og:title" content="کنترل کردن USB Switcher با موبایل"/><meta data-react-helmet="true" property="og:site_name" content="Sahand&#x27;s blog"/><style data-href="/styles.1906a6c925635f62b029.css" data-identity="gatsby-global-css">:root{--lr-padding:10px;--border-radius:8px;--primary-color-active:#ff7e14;--primary-color-inactive:#ffd1ac;--secondary-color:#fffcf9;--anim-duration:300ms;--paragraph-width:calc(min(760px, 100%));--code-width:min(100%,calc(var(--paragraph-width) + 12%));--paragraph-padding:calc((var(--code-width) - var(--paragraph-width))/2);font-size:16px}.footnotes,.main-container h1,.text,a,em,h2,h3,h4,h5,h6,li,p,ul{direction:rtl;font-family:Vazir,monospace,Source Code Pro!important;line-height:1.6}.main-container h1,h2,h3,h4,h5,h6{padding-left:var(--paragraph-padding);padding-right:var(--paragraph-padding)}.text a{overflow-wrap:anywhere}.footnotes li{color:#5c6e74;font-size:.8rem!important}.main-container-wrapper{align-items:center;display:flex;flex-direction:column;width:100%}.main-container p{margin:0}a{text-decoration:none}a,a:hover{color:var(--primary-color-active)}a:hover{text-decoration:underline}.main-container{padding-top:1rem;width:var(--code-width)}.main-container img{display:block;margin-left:auto;margin-right:auto;max-height:500px;max-width:80%}.main-container .img-container{max-width:100%}@media screen and (max-width:768px){:root{--lr-padding:10%}}@media screen and (max-width:375px){:root{--lr-padding:5%}.main-container{margin-top:0;padding-top:0!important}.main-container h1{margin-top:10px}.main-container blockquote{margin:25px 0 0}.main-container img{max-width:100%;vertical-align:top}.main-container .img-container{overflow-x:auto}}.main-container li{font-size:1.2rem;margin-left:var(--paragraph-padding);margin-right:var(--paragraph-padding);margin-top:.6rem;padding:0;text-align:justify}.main-container p,.text{font-size:1.2rem;padding-left:var(--paragraph-padding);padding-right:var(--paragraph-padding);text-align:justify}.main-container blockquote .text{--h-space:10px;--v-space:4px;background-color:#e7e7e7;border-radius:var(--border-radius);border-right:5px solid var(--primary-color-inactive);margin-left:calc(var(--paragraph-padding)*1.3);margin-right:calc(var(--paragraph-padding)*1.3);padding:var(--v-space) var(--h-space);transition:border-right var(--anim-duration)}.main-container blockquote .text:hover{border-right-color:var(--primary-color-active)}.resources .text{direction:ltr;font-size:.8rem;text-align:start}.main-container code{background-color:#f1f1f1;border-radius:var(--border-radius);direction:ltr!important;font-size:1.1rem;padding-left:6px;padding-right:6px;text-align:left;white-space:nowrap}.playground-button{background-color:var(--primary-color-active);border-bottom-left-radius:var(--border-radius);padding:0 5px;position:absolute;right:0;top:0}.playground-button a{color:#fff;font-size:.8rem;margin:0}.playground-button a:hover{text-decoration:none}code[class*=language-],pre[class*=language-]{color:#5c6e74;direction:ltr;font-family:Source Code Pro,Andale Mono,Ubuntu Mono,monospace;font-size:1rem;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:none;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::mozselection,code[class*=language-]::selection,pre[class*=language-]::mozselection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{background:var(--secondary-color);border:1px solid var(--primary-color-inactive);border-radius:var(--border-radius);margin:.5em 0;overflow:auto;padding:.8em;transition:border var(--anim-duration)}pre[class*=language-]:hover{border:1px solid var(--primary-color-active)}:not(pre)>code[class*=language-]{background:#f9f2f4;border-radius:.3em;color:#db4c69;padding:.1em .3em}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#999}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:#fff;color:#a67f59}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{background:#f7ebc6;box-shadow:inset 5px 0 0 #f7d87c;left:0;line-height:inherit;margin-top:1em;padding-bottom:inherit;padding-left:0;padding-right:0;padding-top:inherit;pointer-events:none;position:absolute;right:0;white-space:pre;z-index:0}.footnotes,.post-list-container h1,.text,a,em,h2,h3,h4,h5,h6,li,p,ul{font-family:Vazir,monospace,Source Code Pro!important;line-height:1.6;margin:0;padding:0}.post-list-container ul{list-style-type:circle;padding:0}.post-list-container li a{color:#121212;text-decoration-style:dotted}.post-list-container li{margin-top:16px}.category-container .badge{background-color:var(--primary-color-active);border-radius:5px;color:#fff;margin-left:5px;padding-left:4px;padding-right:4px}.post-list-container{direction:rtl;display:flex;flex-direction:row;flex-wrap:wrap;padding:3rem}.category-container{margin:2rem 1rem;width:calc(50% - 2rem)}.category-container .hr{background-color:var(--primary-color-active);border-radius:5px;height:5px;margin-bottom:1rem;margin-top:.1rem;width:40%}@media screen and (max-width:425px){.category-container{width:100%}.post-list-container{padding:1rem}}.social{display:flex;flex-direction:row;font-family:Source Code Pro!important;font-size:.9rem;justify-content:center;margin-top:20px;width:100%}.social a{color:grey!important;opacity:.6;transition:.2s}.social a:hover{opacity:1}.social p{margin-left:10px;margin-right:10px}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">کنترل کردن USB Switcher با موبایل</title><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="main-container-wrapper"><div class="main-container"><h1>کنترل کردن USB Switcher با موبایل</h1><br/><div class="text">ستاپ من اینطوریه که یک لپ‌تاپ دارم که اکثر وقتا با اون کار می‌کنم و یک PC هم هست که به عنوان سرور و سیستم ویندوزیم ازش استفاده می‌کنم. این وسط یک میکروفون دارم که با USB وصل می‌تونه بشه به یکی از این سیستم‌ها. مشکل اینجاست که بعضی وقتا میخوام میکروفون رو روی لپ‌تاپ استفاده کنم بعضی وقتا روی PC. یک راهش اینه که USB رو جدا کنم و بین این دوتا سوئیچ کنم. یک راه هم اینه که از USB Switcher استفاده کنم. اومدم چند وقت پیش یکی از اینارو گرفتم:</div><br/><br/><div class="text"><a class="img-container" href="/images/us-1.png" target="_blank"><img src="/images/us-1.png" alt="usb switcher" dir="ltr"/></a></div><br/><br/><div class="text">سمت راست و چپ رو با دو تا کابل پرینتر می‌تونم وصل کنم به دوتا سیستم و از بالا هم می‌تونم میکروفون رو وصل کنم. دکمه روش هم وقتی بزنم بین این دوتا سوئیچ می‌شه. چراغ روش هم مشخص می‌کنه الان کدوم یکیش فعاله. اول روی میز گذاشته بودمش ولی چون ظاهر زیاد قشنگی نداشت گذاشتمش گذاشتم زیر میز و با شست پام دکمشو میزنم 😀</div><br/><div class="text">تا همینجا در اصل مشکلمو حل کردم ولی از همون اول که راش انداختم دوست داشتم که بشه با گوشی یا خود لپ‌تاپ هم سوئیچش کرد. USB Switcher ای که همچین کاری رو بکنه و قیمت معقولانه‌ای هم داشته باشه پیدا نکردم. چند روز پیش دست به هویه شدم و گفتم خودم درستش میکنم.</div><br/><br/><h2>بازش کنیم ببینیم چطور کار میکنه</h2><br/><br/><div class="text"><a class="img-container" href="/images/us-2.png" target="_blank"><img src="/images/us-2.png" alt="usb switcher inside" dir="ltr"/></a></div><br/><blockquote><div class="text">دیسکلیمر!:  تقریبا هیچ بک‌گراندی توی الکترونیک ندارم و هرچی بلدم رو با آزمون و خطا و چارتا کلیپ توی یوتیوب یاد گرفتم. در نتیجه بزرگان الکترونیک به بزرگی خودتون ببخشید اگر چیزی رو اشتباه می‌گم و همیطور خوشحال می‌شم بهم بگید تا بتونم متن رو اصلاح کنم 🙏</div></blockquote><br/><div class="text">اول بازش کردم که ببینم چطوری کار میکنه. اون دکمه‌ای که با شست پا میزدمش اینجاست که در اصل یک Push button ئه و کارش اینه که تا وقتی که نگهش داشتیم اتصال بین دو نقطه رو برقرار می‌کنه. دو نقطه هم مشخص شده رو عکس:</div><div class="text"><a class="img-container" href="/images/us-3.png" target="_blank"><img src="/images/us-3.png" alt="usb switcher push button" dir="ltr"/></a></div><br/><blockquote><div class="text">ممکنه با خودتون بگید این که ۴ تا پایه داره! در اصل دوتا پایه پایین به هم و دوتا پایه بالا به هم وصلن</div></blockquote><div class="text">اومدم با یک تیکه سیم این دو نقطه رو بهم وصل کردم که ببینم سوئیچ میشه یا نه که دیدم می‌شه! خیلی هم عالی!</div><br/><div class="text"><a class="img-container" href="/images/us-4.png" target="_blank"><img src="/images/us-4.png" alt="connect buttons using a usb" dir="ltr"/></a></div><br/><h2>استفاده از یک ترانزیستور</h2><br/><br/><div class="text"><a class="img-container" href="/images/us-5.png" target="_blank"><img src="/images/us-5.png" alt="a transistor" dir="ltr"/></a></div><br/><div class="text">خیلی خلاصه بخوام توضیح بدم اکثر ترانزیستور سه تا پایه دارن:</div><div class="text">چپ Emitter وسط Base و راست Collector هست. کارشم اینه که وقتی یک جریانی از Base به Emitter برقرار باشه، جریان Collector به Emitter باز میشه.</div><br/><div class="text"><a class="img-container" href="/images/us-6.png" target="_blank"><img src="/images/us-6.png" alt="a transistor" dir="ltr"/></a></div><br/><div class="text">یا خیلی ساده‌تر اگه Collector رو به نقطه آبی وصل کنیم و Emitter رو به نقطه قرمز، وقتی به Base یک سیگنال وارد کنیم این دوتا به هم وصل میشه. دقیقا چیزی که میخوایم :)</div><div class="text">دست به هویه شدم و دوتا پایه رو لحیم کردم و یک سیم هم وصل کردم به پایه Base که کارم راحت باشه.</div><br/><div class="text"><a class="img-container" href="/images/us-7.png" target="_blank"><img src="/images/us-7.png" alt="a transistor" dir="ltr"/></a></div><br/><h2>ارسال سیگنال به پایه Base</h2><br/><br/><div class="text">چند سال پیش یک Arduino mega گرفته بودم و استفاده‌ای نمی‌شد ازش. پرفکت! با وصل کردن Arduino به لپ‌تاپ میشه باهاش از طریق tty صحبت کرد. کافیه یک پیام به Arduino بفرستیم و اون بیاد برامون سیگنال رو به Base ترانزیستورمون بفرسته.</div><br/><div class="text"> کد روی board:</div><div style="position:relative"><pre class="prism-code language-c"><div class="token-line"><span class="token keyword">void</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token function">pinMode</span><span class="token punctuation">(</span><span class="token plain">LED_BUILTIN</span><span class="token punctuation">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token function">pinMode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> Serial</span><span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">9600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">void</span><span class="token plain"> </span><span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> String msg </span><span class="token operator">=</span><span class="token plain"> Serial</span><span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">msg</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">   </span><span class="token function">digitalWrite</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> HIGH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">   </span><span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">   </span><span class="token function">digitalWrite</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> LOW</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">   </span><span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><br/><div class="text">کد بالا منتظر می‌مونه یک پیام از پورت Serial بیاد و به مدت ۱۰۰ میلی ثانیه پین ۲ رو HIGH می‌کنه (که تو ستاپ من 5V می‌شه). پین ۲ هم از اون ور وصل شده به Base ترانزیستورمون. اینم عکس اتصالات:</div><br/><div class="text"><a class="img-container" href="/images/us-8.png" target="_blank"><img src="/images/us-8.png" alt="final" dir="ltr"/></a></div><br/><div class="text">حالا کافیه که یک پیام با tty برای دیوایس بفرستم. توی لینوکس خیلی سادست، اسکریپت زیر رو آماده کردم و اسمشو گذاشتم <code dir="ltr">usb-switch.sh</code></div><div style="position:relative"><pre class="prism-code language-bash"><div class="token-line"><span class="token plain">stty -F /dev/ttyACM0 </span><span class="token number">9600</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> 00000 </span><span class="token operator">&gt;</span><span class="token plain"> /dev/ttyACM0</span></div></pre></div><br/><div class="text">و تموم! چون کل دیوایسام توی یک شبکه هستن و با ssh به صورت لوکال می‌تونن صحبت کنن، خیلی راحت می‌تونم از رو گوشیم دستور زیر رو بزنم و با گوشیم هم بتونم سوئیچ کنم.</div><br/><div style="position:relative"><pre class="prism-code language-bash"><div class="token-line"><span class="token function">ssh</span><span class="token plain"> dev-laptop usb-switch.sh</span></div></pre></div><br/><br/></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/usb-switcher/";window.___webpackCompilationHash="972553076a5943065adf";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-1db7d8bb6b2543ab1002.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-d479770c8c96c1ac42f2.js"],"component---src-pages-context-magic-mdx":["/component---src-pages-context-magic-mdx-4b4e4dbf7124a0b0fb00.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-f6d0303ed01f5b962477.js"],"component---src-pages-ratelimit-p-1-mdx":["/component---src-pages-ratelimit-p-1-mdx-ab74d2fc9b92877c5926.js"],"component---src-pages-ratelimit-p-2-mdx":["/component---src-pages-ratelimit-p-2-mdx-a831dc263d1b65146292.js"],"component---src-pages-usb-switcher-mdx":["/component---src-pages-usb-switcher-mdx-d2d9ce5fc9b3b3003e58.js"],"component---src-pages-v-8-ignition-mdx":["/component---src-pages-v-8-ignition-mdx-122560c660255bdbbf38.js"],"component---src-pages-v-8-jit-mdx":["/component---src-pages-v-8-jit-mdx-342275cde6b3adfce9f5.js"],"component---src-pages-v-8-mdx":["/component---src-pages-v-8-mdx-b1b5eabfe647d44e9a52.js"],"component---src-pages-v-8-parser-mdx":["/component---src-pages-v-8-parser-mdx-26d55d7ee79517093435.js"],"component---src-pages-working-memory-mdx":["/component---src-pages-working-memory-mdx-2b870071a2bbbc7332c9.js"]};/*]]>*/</script><script src="/app-1db7d8bb6b2543ab1002.js" async=""></script><script src="/framework-2b6860fea1dc24d063ff.js" async=""></script><script src="/webpack-runtime-1767c23f829f6a4e5908.js" async=""></script></body></html>